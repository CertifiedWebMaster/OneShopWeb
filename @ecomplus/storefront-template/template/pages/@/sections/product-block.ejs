<div class="product-block pb-2 my-4 my-lg-5">
  <div class="container">
    <section id="product" class="product">
      <div class="row" data-to-render="true">
        <% if (_.state.pictures) { %>
          <% const imgObj = _.ecomUtils.img(_.state, null, 'big') %>
          <% if (imgObj) { %>
            <div class="col-12 col-md-6">
              <div class="product__picture">
                <picture
                  class="lozad fade"
                  data-iesrc="<%= imgObj.url %>"
                  data-alt="<%= imgObj.alt %>"
                >
                  <source
                    srcset="<%= _.ecomUtils.img(_.state).url %>"
                    media="(max-width: 399.98px)"
                  >
                  <source srcset="<%= imgObj.url %>" media="(min-width: 400px)">
                </picture>
              </div>
            </div>
          <% } %>
        <% } %>

        <div class="col">
          <h1 class="product__name">
            <%= _.ecomUtils.name(_.state) %>
          </h1>
          <% if (_.state.available && _.state.visible && _.ecomUtils.inStock(_.state)) { %>
            <strong class="product__price">
              <%= _.ecomUtils.formatMoney(_.ecomUtils.price(_.state)) %>
            </strong>
          <% } %>
          <hr>

          <div>
            <div class="spinner-border" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
          <button
            type="button"
            class="product__buy btn btn-lg btn-primary"
            onclick="ecomCart.addProduct(storefront.context.body)"
            <% if (_.state.variations && _.state.variations.length) { %>
              disabled
            <% } %>
          >
            <i class="fas fa-shopping-bag mr-1"></i>
            <%= _.dictionary('buy') %>
          </button>
          <% if (_.state.short_description) { %>
            <p class="lead product__info">
              <%= _.state.short_description %>
            </p>
          <% } %>
        </div>
      </div>
    </section>
  </div>
</div>

<%
const productJsonLd = {
  '@context': 'http://schema.org',
  '@type': 'Product',
  sku: _.state.sku,
  description: _.state.short_description || _.state.meta_description || _.ecomUtils.name(_.state),
  name: _.ecomUtils.name(_.state),
  offers: {
    '@type': 'Offer',
    url: `https://${_.settings.domain}/${_.state.slug}`,
    availability: `${(_.ecomUtils.inStock(_.state) ? 'In' : 'OutOf')}Stock`,
    priceCurrency: _.settings.currency,
    price: _.ecomUtils.price(_.state),
    itemCondition: `http://schema.org/${(_.state.condition === 'new' ? 'New' : 'Used')}Condition`,
    seller: {
      '@type': 'Organization',
      name: _.settings.name || _.store.name
    }
  }
}
if (_.state.brands && _.state.brands[0]) {
  productJsonLd.brand = {
    '@type': 'Brand',
    name: _.state.brands[0].name
  }
}
if (_.state.pictures && _.state.pictures.length) {
  productJsonLd.image = _.ecomUtils.img(_.state, null, 'zoom').url
}
if (_.state.mpn && _.state.mpn[0]) {
  productJsonLd.mpn = _.state.mpn[0]
}
%>
<script type="application/ld+json"><%-
  JSON.stringify(productJsonLd)
%></script>
