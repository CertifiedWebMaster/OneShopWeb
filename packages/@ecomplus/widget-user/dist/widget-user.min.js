!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o(require("core-js/modules/es.array.for-each"),require("vue"),require("@ecomplus/utils"),require("@ecomplus/passport-client"),require("core-js/modules/es.symbol"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.object.get-own-property-descriptor"),require("core-js/modules/es.object.get-own-property-descriptors"),require("core-js/modules/es.object.keys"),require("core-js/modules/web.dom-collections.for-each"),require("@ecomplus/storefront-twbs"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.find"),require("core-js/modules/es.function.name"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.promise"),require("core-js/modules/es.promise.finally")):"function"==typeof define&&define.amd?define(["core-js/modules/es.array.for-each",,,,"core-js/modules/es.symbol","core-js/modules/es.array.filter","core-js/modules/es.object.get-own-property-descriptor","core-js/modules/es.object.get-own-property-descriptors","core-js/modules/es.object.keys","core-js/modules/web.dom-collections.for-each",,"core-js/modules/es.array.concat","core-js/modules/es.array.find","core-js/modules/es.function.name","core-js/modules/es.number.constructor","core-js/modules/es.object.to-string","core-js/modules/es.promise","core-js/modules/es.promise.finally"],o):"object"==typeof exports?exports.widgetUser=o(require("core-js/modules/es.array.for-each"),require("vue"),require("@ecomplus/utils"),require("@ecomplus/passport-client"),require("core-js/modules/es.symbol"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.object.get-own-property-descriptor"),require("core-js/modules/es.object.get-own-property-descriptors"),require("core-js/modules/es.object.keys"),require("core-js/modules/web.dom-collections.for-each"),require("@ecomplus/storefront-twbs"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.find"),require("core-js/modules/es.function.name"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.promise"),require("core-js/modules/es.promise.finally")):e.widgetUser=o(e["core-js/modules/es.array.for-each"],e.Vue,e.ecomUtils,e.EcomPassport,e["core-js/modules/es.symbol"],e["core-js/modules/es.array.filter"],e["core-js/modules/es.object.get-own-property-descriptor"],e["core-js/modules/es.object.get-own-property-descriptors"],e["core-js/modules/es.object.keys"],e["core-js/modules/web.dom-collections.for-each"],e.__storefront_twbs,e["core-js/modules/es.array.concat"],e["core-js/modules/es.array.find"],e["core-js/modules/es.function.name"],e["core-js/modules/es.number.constructor"],e["core-js/modules/es.object.to-string"],e["core-js/modules/es.promise"],e["core-js/modules/es.promise.finally"])}(window,(function(e,o,t,r,n,s,i,a,c,u,l,p,d,f,m,g,h,v){return function(e){var o={};function t(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=o,t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var n in e)t.d(r,n,function(o){return e[o]}.bind(null,n));return r},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="/assets/vendor/",t(t.s=22)}([function(e,o,t){var r=t(20);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,t(23).default)("5e827ac4",r,!0,{})},function(o,t){o.exports=e},function(e,t){e.exports=o},function(e,o){e.exports=t},function(e,o){e.exports=r},function(e,o){e.exports=n},function(e,o){e.exports=s},function(e,o){e.exports=i},function(e,o){e.exports=a},function(e,o){e.exports=c},function(e,o){e.exports=u},function(e,o){e.exports=l},function(e,o){e.exports=p},function(e,o){e.exports=d},function(e,o){e.exports=f},function(e,o){e.exports=m},function(e,o){e.exports=g},function(e,o){e.exports=h},function(e,o){e.exports=v},function(e,o,t){"use strict";var r=t(0);t.n(r).a},function(e,o,t){(o=t(21)(!1)).push([e.i,".ec-user{display:inline}.ec-user__popover{max-width:100%;min-width:12rem;font-size:1rem;line-height:1.4}.ec-user__alert{font-size:.85rem;margin-bottom:1rem}.ec-user__logout{margin-top:1rem}.ec-user__btn{color:#fff;text-align:left;line-height:1.2rem;padding:.7rem;min-width:15rem;font-size:.9rem}.ec-user__btn:hover{color:#fff}.ec-user__btn:focus{box-shadow:none}.ec-user__btn--facebook{background:#3b5999;border-color:#2f4d8a}.ec-user__btn--facebook:hover{background:#274480;border-color:#274480}.ec-user__btn--google{background:#cb4023;border-color:#be3419}.ec-user__btn--google:hover{background:#c1361a;border-color:#c1361a}.ec-user__btn--windowslive{background:#329ffc;border-color:#2996f2}.ec-user__btn--windowslive:hover{background:#1f8ce9;border-color:#1f8ce9}.ec-user__btn__icon{display:inline-block;width:1.4rem;text-align:center;margin-right:.2rem}.ec-user__back{display:block;padding-left:.3rem;padding-right:.3rem}.ec-user__back:focus{box-shadow:none}.ec-user__visitor-info{font-size:.875rem;margin-top:.6rem;text-align:center;color:var(--gray)}",""]),e.exports=o},function(e,o,t){"use strict";e.exports=function(e){var o=[];return o.toString=function(){return this.map((function(o){var t=function(e,o){var t=e[1]||"",r=e[3];if(!r)return t;if(o&&"function"==typeof btoa){var n=(i=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),s=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[t].concat(s).concat([n]).join("\n")}var i,a,c;return[t].join("\n")}(o,e);return o[2]?"@media ".concat(o[2]," {").concat(t,"}"):t})).join("")},o.i=function(e,t,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(n[i]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&n[c[0]]||(t&&(c[2]?c[2]="".concat(t," and ").concat(c[2]):c[2]=t),o.push(c))}},o}},function(e,o,t){"use strict";t.r(o);t(5),t(6),t(1),t(7),t(8),t(9),t(10);var r=t(2),n=t.n(r),s=(t(11),t(12),t(13),t(14),t(15),t(16),t(17),t(18),t(3)),i={my_account:{en_us:"My account",pt_br:"Minha conta"},my_orders:{en_us:"My orders",pt_br:"Meus pedidos"},hello:{en_us:"Hello",pt_br:"Olá"},visitor:{en_us:"visitor",pt_br:"visitante"},sign_in_with:{en_us:"Sign in with",pt_br:"Entrar com"},sign_up_with:{en_us:"Sign up with",pt_br:"Cadastrar via"},another:{en_us:"another",pt_br:"outro"},email:{en_us:"email",pt_br:"e-mail"},logout:{en_us:"Logout",pt_br:"Sair"},login:{en_us:"Login",pt_br:"Entrar"},continue_on_popup:{en_us:"Continue login on popup",pt_br:"Continue o login no pop-up"},login_error:{en_us:"There was an error trying to login, please try again or select another option",pt_br:"Houve um erro ao tentar o login, por favor tente novamente ou selecione outra opção"},profile_not_found:{en_us:"No profile found with email address",pt_br:"Nenhum perfil encontrado com o endereço de e-mail"},visitor_checkout:{en_us:"You can also buy as a visitor if you prefer",pt_br:"Você também pode comprar como visitante se preferir"}},a=function(e,o){return o||(o=this&&this.lang||"en_us"),i[e]&&i[e][o]||""},c=t(4),u=t.n(c),l={name:"EcUser",props:{lang:{type:String,default:s.$ecomConfig.get("lang")},ecomPassport:{type:Object,default:function(){return u.a}},popoverPlacement:{type:String,default:"bottomleft"},getGreetingsMsg:{type:Function},accountUrl:{type:String,default:"/app/#/account/"},ordersUrl:{type:String,default:"/app/#/account/orders"},popupAlertCountSecs:{type:Number,default:3}},data:function(){return{showPopover:!1,popoverTriggers:"click blur",waiting:!1,waitingPopup:!1,isLogged:!1,email:"",name:"",oauthProviders:[],showLoginForm:!1,popupAlertCount:0,loginErrorAlert:!1,noProfileFound:!1,popoverHideTimer:null}},computed:{greetings:function(){return"function"==typeof this.getGreetingsMsg?this.getGreetingsMsg(this.name):"".concat(a("hello",this.lang)," ").concat(this.name||a("visitor",this.lang))}},methods:{dictionary:a,update:function(){var e=this;this.fixPopoverTriggers();var o=this.ecomPassport,t=o.checkLogin,r=o.getCustomerName;this.name=r(),this.isLogged=t(),this.email="",this.popupAlertCount=0,this.isLogged&&(this.showPopover=!0,setTimeout((function(){e.showPopover&&(e.popoverHideTimer=setTimeout((function(){e.showPopover=!1}),2e3))}),200)),this.waitingPopup=!1,clearTimeout(this.popoverHideTimer)},waitPromise:function(e){this.fixPopoverTriggers();var o=this;o.waiting=!0,e.catch((function(e){console.error(e)})).finally((function(){o.waiting=!1}))},setOauthProviders:function(){var e=this,o=e.ecomPassport.fetchOauthProviders().then((function(o){var t=o.host,r=o.baseUri,n=o.oauthPath,s=o.providers,i=[];for(var a in s)if(s[a]){var c=s[a],u=c.faIcon,l=c.providerName;i.push({link:t+r+a+n,faIcon:u,provider:a,providerName:l})}e.oauthProviders=i})).catch((function(o){throw e.presetOauthProviders(),o}));return e.waitPromise(o),o},presetOauthProviders:function(){this.oauthProviders=[{faIcon:"fa-facebook-f",providerName:"Facebook",provider:"facebook"},{faIcon:"fa-google",providerName:"Google",provider:"google"},{faIcon:"fa-windows",providerName:"Windows",provider:"windowslive"}]},oauthPopup:function(e,o){var t=this;if(this.loginErrorAlert=!1,e)t.ecomPassport.popupOauthLink(e),t.waitingPopup=!0,setTimeout((function(){t.popupAlertCount=t.popupAlertCountSecs}),200);else{var r=t.setOauthProviders().then((function(){var e=t.oauthProviders.find((function(e){return e.provider===o}));t.oauthPopup(e,o)})).catch((function(e){throw t.loginErrorAlert=!0,e}));t.waitPromise(r)}},popupAlertChanged:function(e){this.popupAlertCount=e},emailLoginSubmit:function(e){var o=this;e.preventDefault(),o.showLoginForm=!1;var t=o.ecomPassport.fetchLogin(this.email).catch((function(e){var t=e.response;if(!t||403!==t.status)throw setTimeout((function(){o.loginErrorAlert=!0}),100),e;o.noProfileFound=!0}));o.waitPromise(t)},logout:function(){this.ecomPassport.logout()},resetErrors:function(){this.noProfileFound=this.loginErrorAlert=!1},resetPopover:function(){this.showLoginForm?this.showLoginForm=!1:this.resetErrors()},fixPopoverTriggers:function(){var e=this;this.showPopover&&(this.popoverTriggers="manual",setTimeout((function(){e.popoverTriggers="click blur"}),310))}},mounted:function(){var e=this,o=this;["login","logout"].forEach((function(t){e.ecomPassport.on(t,(function(e){o.update(),o.$emit(t,e)}))})),o.update(),o.setOauthProviders()},watch:{noProfileFound:function(e){!1===e&&(this.email=""),this.showLoginForm=!e},showLoginForm:function(e){var o=this;this.loginErrorAlert=!1,e&&(this.fixPopoverTriggers(),setTimeout((function(){o.$refs.input&&o.$refs.input.focus()}),300))},showPopover:function(){clearTimeout(this.popoverHideTimer)}}};t(19);var p=function(e,o,t,r,n,s,i,a){var c,u="function"==typeof e?e.options:e;if(o&&(u.render=o,u.staticRenderFns=t,u._compiled=!0),r&&(u.functional=!0),s&&(u._scopeId="data-v-"+s),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=c):n&&(c=a?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(e,o){return c.call(o),l(e,o)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,c):[c]}return{exports:e,options:u}}(l,(function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"ec-user"},[e._t("button",[t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.left",modifiers:{hover:!0,left:!0}}],staticClass:"btn btn-lg btn-light",attrs:{type:"button",id:"ec-user-popover",title:e.dictionary("my_account")}},[t("i",{staticClass:"fas fa-user"})])]),t("b-popover",{attrs:{target:"ec-user-popover",triggers:e.popoverTriggers,show:e.showPopover,placement:e.popoverPlacement},on:{"update:show":function(o){e.showPopover=o},hidden:e.resetPopover}},[t("template",{slot:"title"},[e._v(" "+e._s(e.greetings)+" ")]),t("div",{staticClass:"ec-user__popover"},[t("b-alert",{staticClass:"ec-user__alert",attrs:{show:e.loginErrorAlert,fade:"",variant:"warning"}},[e._v(" "+e._s(e.dictionary("login_error"))+". ")]),t("transition-group",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated position-absolute fadeOut faster"}},[e.waiting?t("div",{key:"waiting"},[t("div",{staticClass:"spinner-border m-3",attrs:{role:"status"}},[t("span",{staticClass:"sr-only"},[e._v("Loading...")])])]):e.isLogged?t("div",{key:"logged"},[t("div",{staticClass:"list-group list-group-flush"},[t("a",{staticClass:"list-group-item list-group-item-action",attrs:{href:e.ordersUrl}},[e._v(" "+e._s(e.dictionary("my_orders"))+" ")]),t("a",{staticClass:"list-group-item list-group-item-action",attrs:{href:e.accountUrl}},[e._v(" "+e._s(e.dictionary("my_account"))+" ")])]),t("button",{staticClass:"btn btn-block btn-danger ec-user__logout",attrs:{type:"button"},on:{click:e.logout}},[t("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" "+e._s(e.dictionary("logout"))+" ")])]):e.showLoginForm?t("div",{key:"form"},[t("form",{on:{submit:e.emailLoginSubmit}},[t("div",{staticClass:"form-group"},[t("button",{staticClass:"btn ec-user__back",attrs:{type:"button"},on:{click:function(o){e.showLoginForm=!1}}},[t("i",{staticClass:"fas fa-arrow-left"})]),t("label",{attrs:{for:"ec-user-email"}},[e._v(" "+e._s(e.dictionary("sign_in_with")+" "+e.dictionary("email"))+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],ref:"input",staticClass:"form-control",attrs:{type:"email",id:"ec-user-email",placeholder:"email@mail.com",required:""},domProps:{value:e.email},on:{input:function(o){o.target.composing||(e.email=o.target.value)}}})]),t("button",{staticClass:"btn btn-block btn-primary",attrs:{type:"submit"}},[e._v(" "+e._s(e.dictionary("login"))+" ")])])]):t("div",{key:"oauth"},[t("b-alert",{staticClass:"ec-user__alert",attrs:{show:!e.popupAlertCount&&e.noProfileFound,fade:"",variant:"info"}},[e._v(" "+e._s(e.dictionary("profile_not_found"))+" "),t("b",[e._v(e._s(e.email))]),e._v(". "),t("br"),t("a",{staticClass:"alert-link",attrs:{href:"javascript:;"},on:{click:function(o){e.noProfileFound=!1}}},[e._v(" "+e._s(e.dictionary("sign_in_with")+" "+e.dictionary("another")+" "+e.dictionary("email"))+" ")])]),t("b-alert",{staticClass:"ec-user__alert",attrs:{show:e.popupAlertCount,dismissible:"",fade:"",variant:"info"},on:{dismissed:function(o){e.popupAlertCount=0},"dismiss-count-down":e.popupAlertChanged}},[e._v(" "+e._s(e.dictionary("continue_on_popup"))+". ")]),e._l(e.oauthProviders,(function(o){var r=o.link,n=o.faIcon,s=o.providerName,i=o.provider;return t("button",{key:i,staticClass:"btn btn-block ec-user__btn",class:"ec-user__btn--"+i,attrs:{type:"button"},on:{click:function(){return e.oauthPopup(r,i)}}},[t("span",{staticClass:"ec-user__btn__icon"},[t("i",{staticClass:"fab",class:n})]),e._v(" "+e._s(e.dictionary(e.noProfileFound?"sign_up_with":"sign_in_with"))+" "+e._s(s)+" ")])})),e.noProfileFound?t("div",{staticClass:"ec-user__visitor-info"},[e._v(" "+e._s(e.dictionary("visitor_checkout"))+" ")]):t("button",{key:"email",staticClass:"btn btn-block btn-secondary ec-user__btn",attrs:{type:"button"},on:{click:function(o){e.showLoginForm=!0}}},[t("span",{staticClass:"ec-user__btn__icon"},[t("i",{staticClass:"fas fa-envelope"})]),e._v(" "+e._s(e.dictionary("sign_in_with")+" "+e.dictionary("email"))+" ")])],2)])],1)],2)],2)}),[],!1,null,null,null).exports;function d(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?d(Object(t),!0).forEach((function(o){m(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}function m(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}
/*!
 * @ecomplus/widget-user
 * (c) E-Com Club <ti@e-com.club>
 * Released under the MIT License.
 */o.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user-button",t=document.getElementById(o);t&&new n.a({render:function(t){return t(p,{attrs:{id:o},props:f({},e.props)})}}).$mount(t)}},function(e,o,t){"use strict";function r(e,o){for(var t=[],r={},n=0;n<o.length;n++){var s=o[n],i=s[0],a={id:e+":"+n,css:s[1],media:s[2],sourceMap:s[3]};r[i]?r[i].parts.push(a):t.push(r[i]={id:i,parts:[a]})}return t}t.r(o),t.d(o,"default",(function(){return f}));var n="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!n)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var s={},i=n&&(document.head||document.getElementsByTagName("head")[0]),a=null,c=0,u=!1,l=function(){},p=null,d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,o,t,n){u=t,p=n||{};var i=r(e,o);return m(i),function(o){for(var t=[],n=0;n<i.length;n++){var a=i[n];(c=s[a.id]).refs--,t.push(c)}o?m(i=r(e,o)):i=[];for(n=0;n<t.length;n++){var c;if(0===(c=t[n]).refs){for(var u=0;u<c.parts.length;u++)c.parts[u]();delete s[c.id]}}}}function m(e){for(var o=0;o<e.length;o++){var t=e[o],r=s[t.id];if(r){r.refs++;for(var n=0;n<r.parts.length;n++)r.parts[n](t.parts[n]);for(;n<t.parts.length;n++)r.parts.push(h(t.parts[n]));r.parts.length>t.parts.length&&(r.parts.length=t.parts.length)}else{var i=[];for(n=0;n<t.parts.length;n++)i.push(h(t.parts[n]));s[t.id]={id:t.id,refs:1,parts:i}}}}function g(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function h(e){var o,t,r=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(r){if(u)return l;r.parentNode.removeChild(r)}if(d){var n=c++;r=a||(a=g()),o=_.bind(null,r,n,!1),t=_.bind(null,r,n,!0)}else r=g(),o=y.bind(null,r),t=function(){r.parentNode.removeChild(r)};return o(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;o(e=r)}else t()}}var v,b=(v=[],function(e,o){return v[e]=o,v.filter(Boolean).join("\n")});function _(e,o,t,r){var n=t?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(o,n);else{var s=document.createTextNode(n),i=e.childNodes;i[o]&&e.removeChild(i[o]),i.length?e.insertBefore(s,i[o]):e.appendChild(s)}}function y(e,o){var t=o.css,r=o.media,n=o.sourceMap;if(r&&e.setAttribute("media",r),p.ssrId&&e.setAttribute("data-vue-ssr-id",o.id),n&&(t+="\n/*# sourceURL="+n.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}]).default}));
//# sourceMappingURL=widget-user.min.js.map