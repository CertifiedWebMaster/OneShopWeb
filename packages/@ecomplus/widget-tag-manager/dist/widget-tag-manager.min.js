!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@ecomplus/shopping-cart"),require("@ecomplus/utils"),require("core-js/modules/es.function.name"),require("core-js/modules/es.number.to-fixed"),require("core-js/modules/es.array.for-each"),require("core-js/modules/web.dom-collections.for-each"),require("core-js/modules/es.regexp.exec"),require("core-js/modules/es.string.replace"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.map"),require("core-js/modules/es.symbol"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.object.assign"),require("core-js/modules/es.object.get-own-property-descriptor"),require("core-js/modules/es.object.get-own-property-descriptors"),require("core-js/modules/es.object.keys")):"function"==typeof define&&define.amd?define([,,"core-js/modules/es.function.name","core-js/modules/es.number.to-fixed","core-js/modules/es.array.for-each","core-js/modules/web.dom-collections.for-each","core-js/modules/es.regexp.exec","core-js/modules/es.string.replace","core-js/modules/es.array.index-of","core-js/modules/es.array.map","core-js/modules/es.symbol","core-js/modules/es.array.filter","core-js/modules/es.object.assign","core-js/modules/es.object.get-own-property-descriptor","core-js/modules/es.object.get-own-property-descriptors","core-js/modules/es.object.keys"],r):"object"==typeof exports?exports.widgetTagManager=r(require("@ecomplus/shopping-cart"),require("@ecomplus/utils"),require("core-js/modules/es.function.name"),require("core-js/modules/es.number.to-fixed"),require("core-js/modules/es.array.for-each"),require("core-js/modules/web.dom-collections.for-each"),require("core-js/modules/es.regexp.exec"),require("core-js/modules/es.string.replace"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.map"),require("core-js/modules/es.symbol"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.object.assign"),require("core-js/modules/es.object.get-own-property-descriptor"),require("core-js/modules/es.object.get-own-property-descriptors"),require("core-js/modules/es.object.keys")):e.widgetTagManager=r(e.ecomCart,e.ecomUtils,e["core-js/modules/es.function.name"],e["core-js/modules/es.number.to-fixed"],e["core-js/modules/es.array.for-each"],e["core-js/modules/web.dom-collections.for-each"],e["core-js/modules/es.regexp.exec"],e["core-js/modules/es.string.replace"],e["core-js/modules/es.array.index-of"],e["core-js/modules/es.array.map"],e["core-js/modules/es.symbol"],e["core-js/modules/es.array.filter"],e["core-js/modules/es.object.assign"],e["core-js/modules/es.object.get-own-property-descriptor"],e["core-js/modules/es.object.get-own-property-descriptors"],e["core-js/modules/es.object.keys"])}(window,(function(e,r,o,t,s,c,n,u,i,a,d,l,p,m,f,j){return function(e){var r={};function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=e,o.c=r,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)o.d(t,s,function(r){return e[r]}.bind(null,s));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="/assets/vendor/",o(o.s=16)}([function(r,o){r.exports=e},function(e,o){e.exports=r},function(e,r){e.exports=o},function(e,r){e.exports=t},function(e,r){e.exports=s},function(e,r){e.exports=c},function(e,r){e.exports=n},function(e,r){e.exports=u},function(e,r){e.exports=i},function(e,r){e.exports=a},function(e,r){e.exports=d},function(e,r){e.exports=l},function(e,r){e.exports=p},function(e,r){e.exports=m},function(e,r){e.exports=f},function(e,r){e.exports=j},function(e,r,o){"use strict";o.r(r);o(2),o(6),o(7);var t=o(1),s=(o(3),t.$ecomConfig.get("currency")||"BRL"),c=function(e){var r={name:Object(t.name)(e),id:e.sku,price:Object(t.price)(e).toFixed(2)};return e.quantity&&(r.quantity=e.quantity),r},n=function(e){var r=window.storefront&&window.storefront.context;if(r&&"products"===r.resource){var o=r.body,n=c(o),u={event:"eec.detail",ecommerce:{currencyCode:s,detail:{products:[n]}}},i=Object(t.categoriesList)(o);i.length&&(n.category=o.category_tree?o.category_tree.replace(/\s>\s/g,"/"):i[0],u.ecommerce.detail.actionField={list:i[0]}),o.brands&&o.brands.length&&(n.brand=o.brands[0].name),e.push(u)}},u=(o(8),o(9),function(e){var r=document.querySelectorAll("[data-sku]");if(r.length){for(var o=[],t={},c="/search"===window.location.pathname,n=0;n<r.length;n++){var u=r[n],i=u.dataset.sku;if(-1===o.indexOf(i)&&(o.push(i),u.closest)){var a=u.closest(".products-carousel");!c&&a&&(t[i]=a.dataset.title)}}e.push({event:"eec.impressions",ecommerce:{currencyCode:s,impressions:o.map((function(e){var r=c?"Search results":t[e],o={id:e};return r&&(o.list=r),o}))}})}}),i=(o(4),o(5),o(0)),a=o.n(i),d=function(e){var r=window.storefrontApp&&window.storefrontApp.router;if(r){var o=!1,t=function(){var e=[];return a.a.data&&Array.isArray(a.a.data.items)&&a.a.data.items.forEach((function(r){e.push(c(r))})),e},n=function(r,c){var n={step:r,option:c};r<=1||!o?(e.push({event:"eec.checkout",ecommerce:{currencyCode:s,checkout:{actionField:n,products:t()}}}),e.push({event:"checkout"}),o=!0):(e.push({event:"eec.checkout_option",ecommerce:{currencyCode:s,checkout_option:{actionField:n}}}),e.push({event:"checkoutOption"}))},u=function(r){var o,c,u,i=r.name,d=r.params;switch(i){case"cart":n(1,"Review Cart");break;case"checkout":n(2,"Confirm Purchase");break;case"confirmation":o=d.id,c=window.storefrontApp.amount,u=(c&&c.total||a.a.data&&a.a.data.subtotal||0).toFixed(2),e.push({event:"eec.purchase",ecommerce:{currencyCode:s,purchase:{actionField:{id:o,revenue:u},products:t()}}})}};r.currentRoute&&u(r.currentRoute),r.afterEach(u)}};o(10),o(11),o(12),o(13),o(14),o(15);function l(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function p(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?l(Object(o),!0).forEach((function(r){m(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}function m(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}var f=function(e){var r={},o=function(o){var t=c(o);e.push({event:"eec.add",ecommerce:{currencyCode:s,add:{products:[t]}}}),e.push({event:"addToCart"}),r[o.sku]=t},t=function(o){var t=r[o.sku];e.push({event:"eec.remove",ecommerce:{currencyCode:s,remove:{products:[t?Object.assign({},t):c(o)]}}}),e.push({event:"removeFromCart"}),delete r[o.sku]};a.a.on("addItem",(function(e){var r=e.item;return o(r)})),a.a.on("increaseItemQnt",(function(e){var s=e.item,c=r[s.sku];if(c){var n=s.quantity-c.quantity;n>0?o(p({},s,{quantity:n})):t(p({},s,{quantity:-n}))}else o(s)})),a.a.on("removeItem",(function(e){var r=e.item;return t(r)})),a.a.on("clear",(function(){for(var e in r)r[e]&&t(r[e])}))};r.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.dataLayerVar,o=e.parseDomMsDelay,t=window[r]||window.dataLayer;t&&(n(t),d(t),f(t),setTimeout((function(){u(t)}),o>=0?o:300))}}]).default}));
//# sourceMappingURL=widget-tag-manager.min.js.map