<div class="ec-payment">
  <slide-y-up-transition group>
    <div
      v-if="waiting"
      key="waiting"
      class="spinner-border spinner-border-sm"
      role="status"
    >
      <span class="sr-only">Loading...</span>
    </div>

    <div v-else key="gateways" class="list-group">
      <a
        href="#"
        class="ec-payment__gateway list-group-item list-group-item-action"
        v-for="(gateway, i) in paymentGateways"
        v-show="selectedGateway === -1 || selectedGateway === i"
        :key="gateway.app_id + gateway.payment_method.code + i"
        @click.prevent="selectedGateway = i"
        :data-intermediator="gateway.intermediator && gateway.intermediator.name"
      >
        <span class="ec-payment__title">
          <span>{{ gateway.label }}</span>
          <span class="ec-payment__icon">
            <i class="fas" :class="`fa-${gatewayIcon(gateway)}`"></i>
          </span>
        </span>

        <span class="ec-payment__badges">
          <span
            class="badge badge-success ec-payment__discount"
            v-if="gateway.discount && gateway.discount.value > 0"
          >
            <template v-if="gateway.discount.type === 'percentage'">
              {{ gateway.discount.value }}%
            </template>
            <template v-else>
              {{ formatMoney(gateway.discount.value) }}
            </template>
            {{ i18n('OfDiscount') }}
            <template v-if="gateway.discount.apply_at === 'freight'">
              {{ i18n('OnFreight') }}
            </template>
          </span>

          <span
            class="badge badge-info ec-payment__installment"
            v-if="gateway.installment_option"
          >
            {{ i18n('UpTo') }}
            {{ gateway.installment_option.number }}x
            <template v-if="!gateway.installment_option.tax">
              {{ i18n('InterestFree') }}
            </template>
          </span>
        </span>

        <span
          class="ec-payment__text"
          v-if="gateway.text"
          v-html="gateway.text"
        ></span>

        <img
          class="ec-payment__stamp"
          v-if="gateway.icon"
          :src="gateway.icon"
        />
      </a>

      <fade-transition>
        <div class="list-group-item" v-if="selectedGateway > -1">
          <button
            class="btn btn-sm btn-light"
            type="button"
            @click="selectedGateway = -1"
          >
            <i class="fa fa-pencil-alt mr-1"></i>
            {{ i18n('ChangePaymentMethod') }}
          </button>
        </div>
      </fade-transition>
    </div>
  </slide-y-up-transition>
</div>
